<script src="<?php echo $this->config->base_url(); ?>assets/Chart.bundle.js"></script><script src="<?php echo $this->config->base_url(); ?>assets/utils.js"></script> <style>    canvas {        -moz-user-select: none;        -webkit-user-select: none;        -ms-user-select: none;    }    </style><div id="wrapper">       <div class="row">			<div class="col-md-12">				<div class="col-md-12" style='text-align:right'></div>				</div>            </div><!--col-->			<div class="row">			<div class="col-md-12">				<div class="col-md-12">								<?php								$attributes = array('class' => 'form-horizontal style-form','id' => 'form' );								echo form_open('cnd_brasil/graficoKpiFederal', $attributes); 								?>								                                <div class="col-md-4">									<table class="table" cellspacing="0" width="80%" style='font-size:12px;border-color: rgba(0,0,0,0.0)!important'>									<thead>									 <tr style=''>																		 <tr style='border-color: rgba(0,0,0,0.0)!important'>										<th  style='text-align:center;font-size:14px;border-color: rgba(0,0,0,0.0)!important'>											<select name="data" id="data" required=""  class='custom-select' style='height:35px;width:150px'>												<option value="">Escolha Mês/Ano</option>												<?php  												foreach($meses as $mes){												$ano = substr($mes->data, 0, 4);												$mes = substr($mes->data, 4, 2);												$dataSelect = $ano.'-'.$mes.'-01';												if($dataSelect == $primeiroDia){											?>													<option value="<?php echo$dataSelect;?>" selected>													<?php echo meses($mes).'-'.$ano;?>												</option>																											<?php }else{ ?>												<option value="<?php echo$dataSelect;?>">													<?php echo meses($mes).'-'.$ano;?>												</option>																											<?php } //fim if											 }//fim foreach											?>												</select> 																			<button class="btn btn-primary" type="submit" style='height:35px!important;margin-top:-5px' >Filtrar</button>																				</form>										</th>									  </tr>									  									   									  									  									 </thead> 									 </table>										                                 </div>											 															</div>														<div class="col-md-12">								 <div class="col-md-12" style='text-align:center'>									<canvas id="canvasWMBR"></canvas>								</div>																<div class="col-md-12">									<BR>								</div>								<div class="col-md-12" style='text-align:center'>									<canvas id="canvasBPBA"></canvas>								</div>								<div class="col-md-12">									<BR>								</div>								<div class="col-md-12" style='text-align:center'>									<canvas id="canvasBPNE"></canvas>								</div>								<div class="col-md-12" style='text-align:center'>									<canvas id="canvasWMS"></canvas>								</div>								<div class="col-md-12" style='text-align:center'>									<canvas id="canvasTB"></canvas>								</div>							</div>																				</div>				                           <form  id='export' target='_blank' action='<?php echo $this->config->base_url(); ?>index.php/cnd_estadual/exportKpi' method='post'>														  <input type='hidden' id='dataExport' name='data'>								  <input type='hidden' id='tipoExport' name='tipo'>							</form>                   </div><!--col-->                                                                                           </div>                                    </div>             </div>   <script>							var color = Chart.helpers.color;							var barChartData = {								labels: [								<?php foreach($WMBR as $pha){										$mesArr = explode('-',$pha['mes_competencia']);									$mes = (meses($mesArr[1]).'/'.$mesArr[0]);									?>									"<?php echo$mes?>",																		<?php }?>								],								datasets: [{									type: 'bar',									label: 'VÁLIDAS',									backgroundColor: window.chartColors.blue,									data: [										<?php foreach($WMBR as $pha){	?>											<?php echo$pha['emitidas']?>,										<?php }?>									]								}, 	{									type: 'bar',									fontSize: 30,									label: 'N VÁLIDAS',									backgroundColor: window.chartColors.red,									data: [										<?php foreach($WMBR as $pha){	?>											<?php echo$pha['n_emitidas']?>,										<?php }?>									]								},{									type: 'bar',									label: '% VÁLIDAS',									backgroundColor: window.chartColors.green,									 fill: false,									 borderColor: window.chartColors.green,									data: [										<?php foreach($WMBR as $pha){	?>											<?php echo $pha['porc']?>,										<?php }?>									]								}, {									type: 'line',									label: 'TARGET 0%',																		backgroundColor: window.chartColors.purple,									borderColor: window.chartColors.purple,									fill: false,									hidden: false,									data: [										<?php foreach($WMBR as $pha){	?>											0,										<?php }?>									],																	}]	,															};							var barChartDataBPBA = {								labels: [								<?php foreach($BPBA as $sand){										$mesArr = explode('-',$sand['mes_competencia']);									$mes = (meses($mesArr[1]).'/'.$mesArr[0]);									?>									"<?php echo$mes?>",																		<?php }?>								],								datasets: [{									type: 'bar',									label: 'VÁLIDAS',									backgroundColor: window.chartColors.blue,									data: [										<?php foreach($BPBA as $sand){	?>											<?php echo$sand['emitidas']?>,										<?php }?>									]								}, 	{									type: 'bar',									fontSize: 30,									label: 'N VÁLIDAS',									backgroundColor: window.chartColors.red,									data: [										<?php foreach($BPBA as $sand){	?>											<?php echo$sand['n_emitidas']?>,										<?php }?>									]								},{									type: 'bar',									label: '% VÁLIDAS',									backgroundColor: window.chartColors.green,									 fill: false,									 borderColor: window.chartColors.green,									data: [										<?php foreach($BPBA as $sand){	?>											<?php echo $sand['porc']?>,										<?php }?>									]								}, {									type: 'line',									label: 'TARGET 0%',										backgroundColor: window.chartColors.purple,									borderColor: window.chartColors.purple,									 fill: false,									data: [										<?php foreach($BPBA as $sand){	?>											0,										<?php }?>									]								}]										};														var barChartDataBPNE = {								labels: [																<?php foreach($BPNE as $alc){										$mesArr = explode('-',$alc['mes_competencia']);									$mes = (meses($mesArr[1]).'/'.$mesArr[0]);									?>									"<?php echo$mes?>",																		<?php }?>								],																datasets: [{									type: 'bar',									label: 'VÁLIDAS',									backgroundColor: window.chartColors.blue,									data: [										<?php foreach($BPNE as $alc){	?>											<?php echo$alc['emitidas']?>,										<?php }?>									]								}, 	{									type: 'bar',									fontSize: 30,									fontStyle: 'bold',									label: 'N VÁLIDAS',									backgroundColor: window.chartColors.red,									data: [										<?php foreach($BPNE as $alc){	?>											<?php echo$alc['n_emitidas']?>,										<?php }?>									]								},{									type: 'bar',									label: '% VÁLIDAS',									backgroundColor: window.chartColors.green,									 fill: false,									 borderColor: window.chartColors.green,									data: [										<?php foreach($BPNE as $alc){	?>											<?php echo $alc['porc']?>,										<?php }?>									]								}, {									type: 'line',									label: 'TARGET 0%',										backgroundColor: window.chartColors.purple,									borderColor: window.chartColors.purple,									 fill: false,									data: [										<?php foreach($BPNE as $sand){	?>											83,										<?php }?>									]								}]										};														var barChartDataWMS = {								labels: [																<?php foreach($WMS as $alc){										$mesArr = explode('-',$alc['mes_competencia']);									$mes = (meses($mesArr[1]).'/'.$mesArr[0]);									?>									"<?php echo$mes?>",																		<?php }?>								],																datasets: [{									type: 'bar',									label: 'VÁLIDAS',									backgroundColor: window.chartColors.blue,									data: [										<?php foreach($WMS as $alc){	?>											<?php echo$alc['emitidas']?>,										<?php }?>									]								}, 	{									type: 'bar',									fontSize: 30,									fontStyle: 'bold',									label: 'N VÁLIDAS',									backgroundColor: window.chartColors.red,									data: [										<?php foreach($WMS as $alc){	?>											<?php echo$alc['n_emitidas']?>,										<?php }?>									]								},{									type: 'bar',									label: '% VÁLIDAS',									backgroundColor: window.chartColors.green,									 fill: false,									 borderColor: window.chartColors.green,									data: [										<?php foreach($WMS as $alc){	?>											<?php echo $alc['porc']?>,										<?php }?>									]								}, {									type: 'line',									label: 'TARGET 0%',										backgroundColor: window.chartColors.purple,									borderColor: window.chartColors.purple,									 fill: false,									data: [										<?php foreach($WMS as $sand){	?>											83,										<?php }?>									]								}]										};														var barChartDataTB = {								labels: [																<?php foreach($TB as $alc){										$mesArr = explode('-',$alc['mes_competencia']);									$mes = (meses($mesArr[1]).'/'.$mesArr[0]);									?>									"<?php echo$mes?>",																		<?php }?>								],																datasets: [{									type: 'bar',									label: 'VÁLIDAS',									backgroundColor: window.chartColors.blue,									data: [										<?php foreach($TB as $alc){	?>											<?php echo$alc['emitidas']?>,										<?php }?>									]								}, 	{									type: 'bar',									fontSize: 30,									fontStyle: 'bold',									label: 'N VÁLIDAS',									backgroundColor: window.chartColors.red,									data: [										<?php foreach($TB as $alc){	?>											<?php echo$alc['n_emitidas']?>,										<?php }?>									]								},{									type: 'bar',									label: '% VÁLIDAS',									backgroundColor: window.chartColors.green,									 fill: false,									 borderColor: window.chartColors.green,									data: [										<?php foreach($TB as $alc){	?>											<?php echo $alc['porc']?>,										<?php }?>									]								}, {									type: 'line',									label: 'TARGET 0%',										backgroundColor: window.chartColors.purple,									borderColor: window.chartColors.purple,									 fill: false,									data: [										<?php foreach($TB as $sand){	?>											0,										<?php }?>									]								}]										};														// Define a plugin to provide data labels							Chart.plugins.register({								afterDatasetsDraw: function(chart, easing) {									// To only draw at the end of animation, check for easing === 1									var ctx = chart.ctx;																		chart.data.datasets.forEach(function (dataset, i) {																				var meta = chart.getDatasetMeta(i);										if (!meta.hidden) {											meta.data.forEach(function(element, index) {												// Draw the text in black, with the specified font												ctx.fillStyle = 'rgb(0,32,96)';												if(i==3){													var fontSize = 1;												}else{													var fontSize = 12;												}																								var fontStyle = 'bold';												var fontFamily = 'Helvetica Neue';												ctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);												// Just naively convert to string for now												var dataString = dataset.data[index].toString();												// Make sure alignment settings are correct												ctx.textAlign = 'center';												ctx.textBaseline = 'middle';												var padding = 15;												var position = element.tooltipPosition();												ctx.fillText(dataString, position.x, position.y - (fontSize / 2) - padding);											});										}									});								}							});							window.onload = function() {																Chart.defaults.global.defaultFontColor = '#002060';								Chart.defaults.global.defaultFontStyle = 'bold';																var ctx = document.getElementById("canvasWMBR").getContext("2d");																window.myBar = new Chart(ctx, {									type: 'bar',									data: barChartData,									options: {										responsive: true,										title: {											display: true,											fontFamily:'Arial',											text: 'WMBR - CNDs Federais - Evolu\xE7\xE3o mensal',											lineHeight: 5,											fontColor:'#002060',											fontSize:22,										},										scales: {											yAxes: [{											  scaleLabel: {												display: true,												labelString: 'QUANTIDADE DE CND',												fontColor: '#E74A21',												fontStyle:'bold',											  },																							}],											xAxes: [{											gridLines: {												color: "#F5F5F5",												borderDash: [2, 5],											  },																							}],																						  },										legend: {											display: true,											position: 'bottom',											fontColor:'#002060',												fontSize: 30,											labels: {												fontColor: '#002060',												fontStyle:'bold',												fontSize: 16,																		},																										},											 tooltips: {											  											  enabled: false											},										elements: { 										  point: { 											radius: 0,											hitRadius: 0, 											hoverRadius: 0,										  } 										} 									}								});																var ctx = document.getElementById("canvasBPBA").getContext("2d");								window.myBar = new Chart(ctx, {									type: 'bar',									data: barChartDataBPBA,									options: {																				responsive: true,										title: {											display: true,											fontFamily:'Arial',											text: 'BPBA - CNDs Federais - Evolu\xE7\xE3o mensal',											lineHeight: 5,											fontColor:'#002060',											fontSize:22,										},										scales: {											yAxes: [{											  scaleLabel: {												display: true,												labelString: 'QUANTIDADE DE CND',												fontColor: '#E74A21',												fontStyle:'bold',											  }											}],												xAxes: [{											gridLines: {													color: "#F5F5F5",													borderDash: [2, 5],												  },																								}],											  },										  										legend: {											display: true,											position: 'bottom',											fontColor:'#002060',												fontSize: 30,											labels: {												fontColor: '#002060',												fontStyle:'bold',												fontSize: 16,																		},																										},																						 tooltips: {											  											  enabled: false											},										elements: { 										  point: { 											radius: 0,											hitRadius: 0, 											hoverRadius: 0,										  } 										} 										}								});																var ctx = document.getElementById("canvasBPNE").getContext("2d");								window.myBar = new Chart(ctx, {									type: 'bar',									data: barChartDataBPNE,									options: {										responsive: true,										title: {											display: true,											fontFamily:'Arial',											text: 'BPNE - CNDs Federais - Evolu\xE7\xE3o mensal',											lineHeight: 5,											fontColor:'#002060',											fontSize:22,										},										scales: {											yAxes: [{											  scaleLabel: {												display: true,												labelString: 'QUANTIDADE DE CND',												fontColor: '#E74A21',												fontStyle:'bold',											  }											}],												xAxes: [{											gridLines: {													color: "#F5F5F5",													borderDash: [2, 5],												  },																								}],											  },										legend: {											display: true,											position: 'bottom',											fontColor:'#002060',												fontSize: 30,											fontStyle:'bold',											labels: {												fontColor: '#002060',												fontStyle:'bold',												fontSize: 16,																		},																										},											 tooltips: {											  											  enabled: false											},										elements: { 										  point: { 											radius: 0,											hitRadius: 0, 											hoverRadius: 0,										  } 										} 																			}								});																var ctx = document.getElementById("canvasWMS").getContext("2d");								window.myBar = new Chart(ctx, {									type: 'bar',									data: barChartDataWMS,									options: {										responsive: true,										title: {											display: true,											fontFamily:'Arial',											text: 'WMS - CNDs Federais - Evolu\xE7\xE3o mensal',											lineHeight: 5,											fontColor:'#002060',											fontSize:22,										},										scales: {											yAxes: [{											  scaleLabel: {												display: true,												labelString: 'QUANTIDADE DE CND',												fontColor: '#E74A21',												fontStyle:'bold',											  }											}],												xAxes: [{											gridLines: {													color: "#F5F5F5",													borderDash: [2, 5],												  },																								}],											  },										legend: {											display: true,											position: 'bottom',											fontColor:'#002060',												fontSize: 30,											fontStyle:'bold',											labels: {												fontColor: '#002060',												fontStyle:'bold',												fontSize: 16,																		},																										},											 tooltips: {											  											  enabled: false											},										elements: { 										  point: { 											radius: 0,											hitRadius: 0, 											hoverRadius: 0,										  } 										} 																			}								});																var ctx = document.getElementById("canvasTB").getContext("2d");								window.myBar = new Chart(ctx, {									type: 'bar',									data: barChartDataTB,									options: {										responsive: true,										title: {											display: true,											fontFamily:'Arial',											text: 'TB - CNDs Federais - Evolu\xE7\xE3o mensal',											lineHeight: 5,											fontColor:'#002060',											fontSize:22,										},										scales: {											yAxes: [{											  scaleLabel: {												display: true,												labelString: 'QUANTIDADE DE CND',												fontColor: '#E74A21',												fontStyle:'bold',											  }											}],												xAxes: [{											gridLines: {													color: "#F5F5F5",													borderDash: [2, 5],												  },																								}],											  },										legend: {											display: true,											position: 'bottom',											fontColor:'#002060',												fontSize: 30,											fontStyle:'bold',											labels: {												fontColor: '#002060',												fontStyle:'bold',												fontSize: 16,																		},																										},											 tooltips: {											  											  enabled: false											},										elements: { 										  point: { 											radius: 0,											hitRadius: 0, 											hoverRadius: 0,										  } 										} 																			}								});							};					</script>	